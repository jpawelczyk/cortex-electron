# PowerSync Sync Rules for Cortex
# See https://docs.powersync.com/usage/sync-rules

config:
  edition: 2

bucket_definitions:
  user_data:
    parameters: SELECT request.user_id() AS user_id
    data:
      - SELECT * FROM contexts WHERE user_id = bucket.user_id
      - SELECT * FROM projects WHERE user_id = bucket.user_id
      - SELECT * FROM project_headings WHERE user_id = bucket.user_id
      - SELECT * FROM tasks WHERE user_id = bucket.user_id
      - SELECT * FROM task_checklists WHERE user_id = bucket.user_id
      - SELECT * FROM stakeholders WHERE user_id = bucket.user_id
      - SELECT * FROM meetings WHERE user_id = bucket.user_id
      - SELECT meeting_id || '_' || stakeholder_id AS id, meeting_id, stakeholder_id, user_id FROM meeting_attendees WHERE user_id = bucket.user_id
      - SELECT * FROM notes WHERE user_id = bucket.user_id
      - SELECT note_id || '_' || stakeholder_id AS id, note_id, stakeholder_id, user_id FROM note_stakeholders WHERE user_id = bucket.user_id
      - SELECT project_id || '_' || stakeholder_id AS id, project_id, stakeholder_id, user_id FROM project_stakeholders WHERE user_id = bucket.user_id
      - SELECT * FROM daily_notes WHERE user_id = bucket.user_id
      - SELECT id, user_id, name, permissions, last_used_at, created_at, revoked_at FROM ai_agents WHERE user_id = bucket.user_id
